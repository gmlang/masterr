<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>An Example of the Bootstrap Method &#8211; Become Great at R</title>
<meta name="description" content="When calculating the bias and precision of a sample estimate to the popluation parameter, because we often don’t know the true value of the population parameter and we often only have one sample, we use a procedure called bootstrap. The idea is simple:

">
<meta name="keywords" content="">


<!-- Twitter Cards -->
<meta name="twitter:title" content="An Example of the Bootstrap Method">
<meta name="twitter:description" content="When calculating the bias and precision of a sample estimate to the popluation parameter, because we often don’t know the true value of the population parameter and we often only have one sample, we use a procedure called bootstrap. The idea is simple:

">



<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://masterr.org/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="An Example of the Bootstrap Method">
<meta property="og:description" content="When calculating the bias and precision of a sample estimate to the popluation parameter, because we often don’t know the true value of the population parameter and we often only have one sample, we use a procedure called bootstrap. The idea is simple:

">
<meta property="og:url" content="http://masterr.org/r/an-example-of-the-bootstrap-method/">
<meta property="og:site_name" content="Become Great at R">


<meta name="msvalidate.01" content="F608C5B05384F7B0200AC62F5BB60411">


<link rel="canonical" href="http://masterr.org/r/an-example-of-the-bootstrap-method/">
<link href="http://masterr.org/feed.xml" type="application/atom+xml" rel="alternate" title="Become Great at R Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://masterr.org/assets/css/main.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://masterr.org/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://masterr.org/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://masterr.org/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://masterr.org/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://masterr.org/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://masterr.org/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://masterr.org/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://masterr.org/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://masterr.org/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="http://masterr.org/about/" >About</a></li>
		  
		    
		    <li><a href="http://masterr.org/da/" >Data Analysis</a></li>
		  
		    
		    <li><a href="http://masterr.org/r/" >R</a></li>
		  
		    
		    <li><a href="http://masterr.org/books/" >Books</a></li>
		  
		    
		    <li><a href="http://masterr.org/apps/" >Apps</a></li>
		  
		    
		    <li><a href="http://masterr.org/cartoon/" >Cartoon</a></li>
		  
        <li class="dosearch"><span><i class="fa fa-search"></i> Search</span></li>
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<div class="search-wrapper">
  <div class="search-form">
    <input type="text" class="search-field" placeholder="Search...">
    <button class="close-btn"><i class="fa fa-times-circle fa-2x"></i></button>
    <ul class="search-results post-list"></ul><!-- /.search-results -->
  </div><!-- /.search-form -->
</div><!-- ./search-wrapper -->

<header class="masthead">
	<div class="wrap">
        
    		<a href="http://masterr.org" class="site-logo" rel="home" title="Become Great at R"><img src="http://masterr.org/images/site-logo.png" width="200" height="200" alt="Become Great at R logo" class="animated fadeInUp"></a>
        
        <h1 class="site-title animated fadeIn"><a href="http://masterr.org">Become Great at R</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description"></h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>

<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"></span>
        
          <h1 class="entry-title">An Example of the Bootstrap Method</h1>
        
      </header>
      <footer class="entry-meta">
		<!-- Begin MailChimp Signup Form -->
<html>
<head>
<link href="//cdn-images.mailchimp.com/embedcode/classic-081711.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background: #EBF2F2; clear:left; font:14px Helvetica,Arial,sans-serif; border: 1px solid #ccc; padding: 20px 15px; text-align: center}
    #mc_embed_signup input {
		background: #fff;
		border: 1px solid #ccc;
		font-size: 15px;
		margin-bottom: 10px;
		padding: 8px 10px;
		border-radius: 3px;
		-moz-border-radius: 3px;
		-webkit-border-radius: 3px;
		box-shadow: 0 2px 2px #ddd;
		-moz-box-shadow: 0 2px 2px #ddd;
		-webkit-box-shadow: 0 2px 2px #ddd
	}
	#mc_embed_signup input.name { background: #fff  no-repeat 10px center; padding-left: 5px }
	#mc_embed_signup input.email { background: #fff no-repeat 10px center; padding-left: 5px }
	#mc_embed_signup .button{ background: #217b30; -moz-border-radius: 8; font: 18px; color:#FFFFFF; }
	#mc_embed_signup .button:hover{ background: #217b30; color: #c6ffd1; }
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
</head>
<div id="mc_embed_signup">
<form action="//gmlang.us9.list-manage.com/subscribe/post?u=66768baba1811dbdb4e186167&amp;id=0288c18c07" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
    <div id="mc_embed_signup_scroll">
	<h2>Master R</h2>
<div class="mc-field-group">
	<label for="mce-FIRST_NAME">First Name </label>
	<input type="text" value="" name="FIRST_NAME" class="required name" id="mce-FIRST_NAME">
</div>
<div class="mc-field-group">
	<label for="mce-EMAIL">Email </label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
    <input type="reset" id="chimp-reset-side" style="display:none"/>
</div>
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_66768baba1811dbdb4e186167_0288c18c07" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Sign Up FREE!" name="subscribe" id="mc-embedded-subscribe" class="button side-clear"></div>
    </div>
</form>
</div>
</html>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
	 	$(".side-clear").click(function() {
    		 setTimeout(function(){
				$('#chimp-reset-side').click();
    		 },1000); 
		});
    });
</script> 
<!--End mc_embed_signup-->
        <span class="entry-date date published"><time datetime="2014-10-29T00:00:00+09:00"><i class="fa fa-calendar-o"></i> October 29, 2014</time></span>
        
        
        <span class="author vcard">By <span class="fn">Guangming Lang</span></span>
		<span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
		<span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=&amp;text=An%20Example%20of%20the%20Bootstrap%20Method&amp;url=http://masterr.org/r/an-example-of-the-bootstrap-method/" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=http://masterr.org/r/an-example-of-the-bootstrap-method/" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=http://masterr.org/r/an-example-of-the-bootstrap-method/" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->
        <div class="google-ads" style="margin-top:40px; text-align:center;">
  <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- 160x600 ad -->
  <ins class="adsbygoogle"
       style="display:inline-block;width:160px;height:600px"
       data-ad-client="ca-pub-8728996999064894"
       data-ad-slot="7055819766"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div><!-- /.google-ads --><!-- /.google-ads -->
      </footer>
      <div class="entry-content">
        <p>When calculating the <a href="http://masterr.org/da/bias-and-precision/">bias and precision</a> of a sample estimate to the popluation parameter, because we often don’t know the true value of the population parameter and we often only have one sample, we use a procedure called <em>bootstrap</em>. The idea is simple:</p>

<ol>
  <li>treat the sample as the population</li>
  <li>understand the sampling scheme, i.e., how the sample was taken from the population</li>
  <li>sample the same number of observations with replacement from the sample according to the same sampling scheme</li>
  <li>for each of the new samples, calculate its sample statistic. For example, if you’re interested in the mean of the population, you just calculate the sample average. If you’re interested in the sd of the population, you just calculate the sample sd.</li>
  <li>these sample statistics form a distribution. Take its average and use it as a proxy to the true value of the population parameter. Plug it and the sample statistic of your original sample into <a href="http://masterr.org/da/bias-and-precision/">the formulas of bias and precision</a>.</li>
</ol>

<p>The following is a concrete example implementing the above bootstrap procedure using R and some stock price data.</p>

<p>Step 1. Download the monthly adjusted closing price data of <a href="https://www.google.com/search?client=safari&amp;rls=en&amp;q=VTSMX&amp;ie=UTF-8&amp;oe=UTF-8">VTSMX</a> since Sept 2005 from Yahoo!. Change the class of the time index to yearmon. And calculate continuously compounded returns.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">zoo</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tseries</span><span class="p">)</span><span class="w">

</span><span class="n">VTSMX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get.hist.quote</span><span class="p">(</span><span class="n">instrument</span><span class="o">=</span><span class="s2">"VTSMX"</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="s2">"2005-09-30"</span><span class="p">,</span><span class="w"> 
                       </span><span class="n">end</span><span class="o">=</span><span class="s2">"2014-09-30"</span><span class="p">,</span><span class="w"> </span><span class="n">origin</span><span class="o">=</span><span class="s2">"1970-01-01"</span><span class="p">,</span><span class="w">
                       </span><span class="n">quote</span><span class="o">=</span><span class="s2">"AdjClose"</span><span class="p">,</span><span class="w"> </span><span class="n">provider</span><span class="o">=</span><span class="s2">"yahoo"</span><span class="p">,</span><span class="w">
                       </span><span class="n">compression</span><span class="o">=</span><span class="s2">"m"</span><span class="p">,</span><span class="w"> </span><span class="n">retclass</span><span class="o">=</span><span class="s2">"zoo"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## time series ends   2014-09-02</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">index</span><span class="p">(</span><span class="n">VTSMX</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.yearmon</span><span class="p">(</span><span class="n">index</span><span class="p">(</span><span class="n">VTSMX</span><span class="p">))</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">VTSMX</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"VTSMX"</span><span class="w">
</span><span class="n">ret.cc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">VTSMX</span><span class="p">))</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">ret.cc</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##                 VTSMX
## Oct 2005 -0.018813600
## Nov 2005  0.038941761
## Dec 2005  0.001354186
## Jan 2006  0.034401428</code></pre></figure>

<p>Step 2. Calculate the sample average c.c. returns</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">muhat.VTSMX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">ret.cc</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">muhat.VTSMX</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="s2">"%"</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 0.63%</code></pre></figure>

<p>Step 3. Calculate bias and precision of the mean using bootstrap.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">VTSMX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coredata</span><span class="p">(</span><span class="n">ret.cc</span><span class="p">)</span><span class="w">
</span><span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">999</span><span class="w">
</span><span class="n">muhat.boot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">n.samples</span><span class="p">)</span><span class="w">
</span><span class="n">nobs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">ret.cc</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">boot.data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="n">VTSMX</span><span class="p">,</span><span class="w"> </span><span class="n">nobs</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
        </span><span class="n">muhat.boot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">boot.data</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># bootstrap bias
</span><span class="n">bias</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">muhat.boot</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">muhat.VTSMX</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">bias</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="s2">"%"</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 0.02%</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># bootstrap SE
</span><span class="n">precision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">muhat.boot</span><span class="p">)</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">precision</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="s2">"%"</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 0.45%</code></pre></figure>

<p>Step 4. Instead of doing the bootstrap procedure ourselves, we can use the <code class="highlighter-rouge">boot()</code> function in the <code class="highlighter-rouge">boot</code> library. For example, we can use the following code to calculate the bootstrap bias and precision for the volatility (standard deviation).</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">boot</span><span class="p">)</span><span class="w">

</span><span class="c1"># define a function to be passed in the boot() function
</span><span class="n">sd.boot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c1"># x: data to be resampled
</span><span class="w">        </span><span class="c1"># idx: vector of scrambled indices created by boot() function
</span><span class="w">        </span><span class="c1">#
</span><span class="w">        </span><span class="c1"># returns: sd value computed using resampled data
</span><span class="w">        </span><span class="n">sd</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># pass sd.boot to the boot() function to calculate the bootstrap sd's
</span><span class="n">VTSMX.sd.boot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">boot</span><span class="p">(</span><span class="n">VTSMX</span><span class="p">,</span><span class="w"> </span><span class="n">statistic</span><span class="o">=</span><span class="n">sd.boot</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="m">999</span><span class="p">)</span><span class="w">
</span><span class="nf">class</span><span class="p">(</span><span class="n">VTSMX.sd.boot</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] "boot"</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">VTSMX.sd.boot</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = VTSMX, statistic = sd.boot, R = 999)
## 
## 
## Bootstrap Statistics :
##       original        bias    std. error
## t1* 0.04646892 -0.0003882149 0.004814115</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="p">(</span><span class="n">VTSMX.sd.boot</span><span class="p">)</span></code></pre></figure>

<p><img src="/../figs/2014-10-29-an-example-of-the-bootstrap-method/unnamed-chunk-4-1.png" alt="center" /></p>

<p>Step 5. We can also calculate the bootstrap 95% confidence intervals of the volatility.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># bootstrap confidence interval
</span><span class="n">boot.ci</span><span class="p">(</span><span class="n">VTSMX.sd.boot</span><span class="p">,</span><span class="w"> </span><span class="n">conf</span><span class="o">=</span><span class="m">0.95</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"norm"</span><span class="p">,</span><span class="w"> </span><span class="s2">"perc"</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 999 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = VTSMX.sd.boot, conf = 0.95, type = c("norm", 
##     "perc"))
## 
## Intervals : 
## Level      Normal             Percentile     
## 95%   ( 0.0374,  0.0563 )   ( 0.0372,  0.0561 )  
## Calculations and Intervals on Original Scale</code></pre></figure>

<p>Step 6. A common measure in risk management is Value at Risk (VaR). We can find the bootstrap 95% confidence intervals of the VaR assuming the initial investment is $100,000.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># define a function to calculate VaR
</span><span class="n">VaR.boot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="m">0.05</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="o">=</span><span class="m">100000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c1"># w: initial investment
</span><span class="w">        </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qnorm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w">
        </span><span class="n">w</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nf">exp</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># pass VaR.boot to the boot() function to calculate the bootstrap VaRs
</span><span class="n">VTSMX.VaR.boot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">boot</span><span class="p">(</span><span class="n">VTSMX</span><span class="p">,</span><span class="w"> </span><span class="n">statistic</span><span class="o">=</span><span class="n">VaR.boot</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="o">=</span><span class="m">999</span><span class="p">)</span><span class="w">
</span><span class="n">boot.ci</span><span class="p">(</span><span class="n">VTSMX.VaR.boot</span><span class="p">,</span><span class="w"> </span><span class="n">conf</span><span class="o">=</span><span class="m">0.95</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"norm"</span><span class="p">,</span><span class="w"> </span><span class="s2">"perc"</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 999 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = VTSMX.VaR.boot, conf = 0.95, type = c("norm", 
##     "perc"))
## 
## Intervals : 
## Level      Normal             Percentile     
## 95%   (-8820, -4898 )   (-8896, -4939 )  
## Calculations and Intervals on Original Scale</code></pre></figure>


		<!-- Begin MailChimp Signup Form -->
<html>
<head>
<link href="//cdn-images.mailchimp.com/embedcode/classic-081711.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background: #EBF2F2; clear:left; font:14px Helvetica,Arial,sans-serif; border: 1px solid #ccc; padding: 20px 15px; text-align: center}
	#mc_embed_signup input {
		background: #fff;
		border: 1px solid #ccc;
		font-size: 15px;
		margin-bottom: 10px;
		padding: 8px 10px;
		border-radius: 3px;
		-moz-border-radius: 3px;
		-webkit-border-radius: 3px;
		box-shadow: 0 2px 2px #ddd;
		-moz-box-shadow: 0 2px 2px #ddd;
		-webkit-box-shadow: 0 2px 2px #ddd
	}
	#mc_embed_signup input.name { background: #fff  no-repeat 10px center; padding-left: 5px }
	#mc_embed_signup input.email { background: #fff no-repeat 10px center; padding-left: 5px }
	#mc_embed_signup .button{ background: #217b30; -moz-border-radius: 8; font: 18px; color:#FFFFFF; }
	#mc_embed_signup .button:hover{ background: #217b30; color: #c6ffd1; }
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
</head>
<div id="mc_embed_signup">
<form action="//gmlang.us9.list-manage.com/subscribe/post?u=66768baba1811dbdb4e186167&amp;id=0288c18c07" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
    <div id="mc_embed_signup_scroll">
	<h2>If you enjoyed this post, get updates. It's FREE</h2>
<div class="mc-field-group">
	<label for="mce-FIRST_NAME">Enter Your First Name </label>
	<input type="text" value="" name="FIRST_NAME" class="required name" id="mce-FIRST_NAME">
</div>
<div class="mc-field-group">
	<label for="mce-EMAIL">Enter Your Email </label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
    <input type="reset" id="chimp-reset" style="display:none"/>
</div>
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_66768baba1811dbdb4e186167_0288c18c07" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Get Updates!" name="subscribe" id="mc-embedded-subscribe" class="button bottom-clear"></div>
    </div>
</form>
</div>
</html>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
	 	$(".bottom-clear").click(function() {
    		 setTimeout(function(){
				$('#chimp-reset').click();
    		 },1000); 
		});
    });
</script> 
<!--End mc_embed_signup-->
        <div id="disqus_thread"></div><!-- /#disqus_thread -->
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://masterr.org/r/handy-r-functions-for-summary-statistics/" class="btn" title="Handy R Functions for Summary Statistics">Previous</a>
      
      
        <a href="http://masterr.org/r/analyze-stock-price-data-using-r-part3/" class="btn" title="Analyze Stock Price Data Using R, Part3">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    
<span>&copy; 2017 Guangming Lang. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	
	
	
	
	
	
	
	
	
<!-- no feed button <a href="http://masterr.org/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a> -->
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://masterr.org/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://masterr.org/assets/js/scripts.min.js"></script>

<!-- Jekyll Simple Search option -->
<script>
  $(document).ready(function() {
      $('.search-field').jekyllSearch({
          jsonFile: 'http://masterr.org/search.json',
          searchResults: '.search-results',
          template: '<li><article><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></article></li>',
          fuzzy: true,
          noResults: '<p>Nothing found.</p>'
        });
  });

  (function( $, window, undefined ) {
    
     var bs = {
          close: $(".close-btn"),
          searchform: $(".search-form"),
          canvas: $(".js-menu-screen"),
          dothis: $('.dosearch')
      };
    
    bs.dothis.on('click', function() {
      $('.search-wrapper').css({ display: "block" });
      $('body').toggleClass('no-scroll');
      bs.searchform.toggleClass('active');
      bs.searchform.find('input').focus();
      bs.canvas.toggleClass('is-visible');
    });
    
      bs.close.on('click', function() {
        $('.search-wrapper').removeAttr( 'style' );
        $('body').toggleClass('no-scroll');
        bs.searchform.toggleClass('active');
        bs.canvas.removeClass('is-visible');
    });
  })( jQuery, window );
</script>


<!-- doesn't work optimally 
author's Asynchronous Google Analytics snippet

<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-57697212-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

-->

<!-- google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57697212-1', 'auto');
  ga('send', 'pageview');

</script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'masterrorg'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



<!-- Mathjax -->
<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
	        

</body>
</html>
