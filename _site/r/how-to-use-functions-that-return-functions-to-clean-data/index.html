<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>How to use functions that return functions to clean data &#8211; Become Great at R</title>
<meta name="description" content="We talked about functions that return functions and functions that eat functions. If you are new and curious, you can search my old blog posts. Today, I’m going to show you a real world example of how to use functions that return functions to clean data. By the end of the post, I’m sure you’ll be amazed by their beauty and power. Let’s get started. First, we define 3 functions that return functions.

">
<meta name="keywords" content="">


<!-- Twitter Cards -->
<meta name="twitter:title" content="How to use functions that return functions to clean data">
<meta name="twitter:description" content="We talked about functions that return functions and functions that eat functions. If you are new and curious, you can search my old blog posts. Today, I’m going to show you a real world example of how to use functions that return functions to clean data. By the end of the post, I’m sure you’ll be amazed by their beauty and power. Let’s get started. First, we define 3 functions that return functions.

">



<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://masterr.org/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="How to use functions that return functions to clean data">
<meta property="og:description" content="We talked about functions that return functions and functions that eat functions. If you are new and curious, you can search my old blog posts. Today, I’m going to show you a real world example of how to use functions that return functions to clean data. By the end of the post, I’m sure you’ll be amazed by their beauty and power. Let’s get started. First, we define 3 functions that return functions.

">
<meta property="og:url" content="http://masterr.org/r/how-to-use-functions-that-return-functions-to-clean-data/">
<meta property="og:site_name" content="Become Great at R">


<meta name="msvalidate.01" content="F608C5B05384F7B0200AC62F5BB60411">


<link rel="canonical" href="http://masterr.org/r/how-to-use-functions-that-return-functions-to-clean-data/">
<link href="http://masterr.org/feed.xml" type="application/atom+xml" rel="alternate" title="Become Great at R Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://masterr.org/assets/css/main.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://masterr.org/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://masterr.org/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://masterr.org/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://masterr.org/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://masterr.org/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://masterr.org/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://masterr.org/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://masterr.org/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://masterr.org/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="http://masterr.org/about/" >About</a></li>
		  
		    
		    <li><a href="http://masterr.org/da/" >Data Analysis</a></li>
		  
		    
		    <li><a href="http://masterr.org/r/" >R</a></li>
		  
		    
		    <li><a href="http://masterr.org/books/" >Books</a></li>
		  
		    
		    <li><a href="http://masterr.org/apps/" >Apps</a></li>
		  
		    
		    <li><a href="http://masterr.org/cartoon/" >Cartoon</a></li>
		  
        <li class="dosearch"><span><i class="fa fa-search"></i> Search</span></li>
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<div class="search-wrapper">
  <div class="search-form">
    <input type="text" class="search-field" placeholder="Search...">
    <button class="close-btn"><i class="fa fa-times-circle fa-2x"></i></button>
    <ul class="search-results post-list"></ul><!-- /.search-results -->
  </div><!-- /.search-form -->
</div><!-- ./search-wrapper -->

<header class="masthead">
	<div class="wrap">
        
    		<a href="http://masterr.org" class="site-logo" rel="home" title="Become Great at R"><img src="http://masterr.org/images/site-logo.png" width="200" height="200" alt="Become Great at R logo" class="animated fadeInUp"></a>
        
        <h1 class="site-title animated fadeIn"><a href="http://masterr.org">Become Great at R</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description"></h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>

<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"></span>
        
          <h1 class="entry-title">How to use functions that return functions to clean data</h1>
        
      </header>
      <footer class="entry-meta">
		<!-- Begin MailChimp Signup Form -->
<html>
<head>
<link href="//cdn-images.mailchimp.com/embedcode/classic-081711.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background: #EBF2F2; clear:left; font:14px Helvetica,Arial,sans-serif; border: 1px solid #ccc; padding: 20px 15px; text-align: center}
    #mc_embed_signup input {
		background: #fff;
		border: 1px solid #ccc;
		font-size: 15px;
		margin-bottom: 10px;
		padding: 8px 10px;
		border-radius: 3px;
		-moz-border-radius: 3px;
		-webkit-border-radius: 3px;
		box-shadow: 0 2px 2px #ddd;
		-moz-box-shadow: 0 2px 2px #ddd;
		-webkit-box-shadow: 0 2px 2px #ddd
	}
	#mc_embed_signup input.name { background: #fff  no-repeat 10px center; padding-left: 5px }
	#mc_embed_signup input.email { background: #fff no-repeat 10px center; padding-left: 5px }
	#mc_embed_signup .button{ background: #217b30; -moz-border-radius: 8; font: 18px; color:#FFFFFF; }
	#mc_embed_signup .button:hover{ background: #217b30; color: #c6ffd1; }
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
</head>
<div id="mc_embed_signup">
<form action="//gmlang.us9.list-manage.com/subscribe/post?u=66768baba1811dbdb4e186167&amp;id=0288c18c07" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
    <div id="mc_embed_signup_scroll">
	<h2>Master R</h2>
<div class="mc-field-group">
	<label for="mce-FIRST_NAME">First Name </label>
	<input type="text" value="" name="FIRST_NAME" class="required name" id="mce-FIRST_NAME">
</div>
<div class="mc-field-group">
	<label for="mce-EMAIL">Email </label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
    <input type="reset" id="chimp-reset-side" style="display:none"/>
</div>
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_66768baba1811dbdb4e186167_0288c18c07" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Sign Up FREE!" name="subscribe" id="mc-embedded-subscribe" class="button side-clear"></div>
    </div>
</form>
</div>
</html>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
	 	$(".side-clear").click(function() {
    		 setTimeout(function(){
				$('#chimp-reset-side').click();
    		 },1000); 
		});
    });
</script> 
<!--End mc_embed_signup-->
        <span class="entry-date date published"><time datetime="2015-09-05T00:00:00+09:00"><i class="fa fa-calendar-o"></i> September 05, 2015</time></span>
        
        
        <span class="author vcard">By <span class="fn">Guangming Lang</span></span>
		<span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
		<span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=&amp;text=How%20to%20use%20functions%20that%20return%20functions%20to%20clean%20data&amp;url=http://masterr.org/r/how-to-use-functions-that-return-functions-to-clean-data/" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=http://masterr.org/r/how-to-use-functions-that-return-functions-to-clean-data/" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=http://masterr.org/r/how-to-use-functions-that-return-functions-to-clean-data/" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->
        <div class="google-ads" style="margin-top:40px; text-align:center;">
  <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- 160x600 ad -->
  <ins class="adsbygoogle"
       style="display:inline-block;width:160px;height:600px"
       data-ad-client="ca-pub-8728996999064894"
       data-ad-slot="7055819766"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div><!-- /.google-ads --><!-- /.google-ads -->
      </footer>
      <div class="entry-content">
        <p>We talked about functions that return functions and functions that eat functions. If you are new and curious, you can search my old blog posts. Today, I’m going to show you a real world example of how to use functions that return functions to clean data. By the end of the post, I’m sure you’ll be amazed by their beauty and power. Let’s get started. First, we define 3 functions that return functions.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">split_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">char</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c1"># Returns a function that can be used to split a character vector by char
</span><span class="w">        </span><span class="c1">#
</span><span class="w">        </span><span class="c1"># char: a string indicating where to split, for example, "," or ", "
</span><span class="w">        </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="c1"># x: a character vector
</span><span class="w">                </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">elt</span><span class="p">)</span><span class="w"> </span><span class="n">strsplit</span><span class="p">(</span><span class="n">elt</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="p">)[[</span><span class="m">1</span><span class="p">]])</span><span class="w">
                </span><span class="n">data.frame</span><span class="p">(</span><span class="n">do.call</span><span class="p">(</span><span class="s2">"rbind"</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">),</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">rm_char</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">char</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c1"># Returns a function that can be used to remove the character(s) 
</span><span class="w">        </span><span class="c1"># represented by char from all the elements of a character vector
</span><span class="w">        </span><span class="c1">#
</span><span class="w">        </span><span class="c1"># char: a string or regular expression
</span><span class="w">        </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="c1"># x: a character vector
</span><span class="w">                </span><span class="n">gsub</span><span class="p">(</span><span class="n">char</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">fix_missing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">na_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c1"># Returns a function that can be used to replace the values represented
</span><span class="w">        </span><span class="c1"># by na_val with NA in a vector.
</span><span class="w">        </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="c1"># x: a numeric or character vector
</span><span class="w">                </span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">na_val</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="w">
                </span><span class="n">x</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>Make sure you read these function definitions line by line three times before you move forward.</p>

<p>Next, we make some messy data.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">dat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read.table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="o">=</span><span class="s1">'
                city_state zipcode
                "BEDMINISTER, NJ" "07921 -7028"
                "ALTURAS, CA" "96101-3113"
                "ALTURAS, CA" "96101- 3113"
                "STOCKTON, CA" "95207 - "
                "MADRAS, OR" "97741 - "'</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="o">=</span><span class="nb">F</span><span class="p">)</span><span class="w">
</span><span class="n">dat</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##        city_state     zipcode
## 1 BEDMINISTER, NJ 07921 -7028
## 2     ALTURAS, CA  96101-3113
## 3     ALTURAS, CA 96101- 3113
## 4    STOCKTON, CA    95207 - 
## 5      MADRAS, OR    97741 -</code></pre></figure>

<p>I’ve cleaned much worse data, but this is good and representative enough for our purpose. Here’re the places we need to clean up:</p>
<ol>
  <li>the city and state are in one column, and we need to separate it into two columns.</li>
  <li>the first 5 and last 4 digits of the zip code are in one column, and we also want to separate them into two columns.</li>
  <li>we need to make sure the separated columns do not contain spaces.</li>
  <li>if a value is missing in the newly created columns, we need to make sure it’s NA instead of “”.</li>
</ol>

<p>First, let’s separate city and state.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># make a function to split by comma
</span><span class="n">split_by_comma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split_by</span><span class="p">(</span><span class="s2">","</span><span class="p">)</span><span class="w">
</span><span class="c1"># split city_state by comma using the function just made
</span><span class="n">dat_part1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split_by_comma</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">city_state</span><span class="p">)</span><span class="w">
</span><span class="c1"># update the column names
</span><span class="nf">names</span><span class="p">(</span><span class="n">dat_part1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"city"</span><span class="p">,</span><span class="w"> </span><span class="s2">"state"</span><span class="p">)</span><span class="w">
</span><span class="c1"># print the result
</span><span class="n">dat_part1</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##          city state
## 1 BEDMINISTER    NJ
## 2     ALTURAS    CA
## 3     ALTURAS    CA
## 4    STOCKTON    CA
## 5      MADRAS    OR</code></pre></figure>

<p>Next, let’s divide zipcode into first 5 and last 4 digits.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># make a function to split by dash
</span><span class="n">split_by_dash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split_by</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span><span class="w">
</span><span class="c1"># split zipcode by dash using the function just made
</span><span class="n">dat_part2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split_by_dash</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">zipcode</span><span class="p">)</span><span class="w">
</span><span class="c1"># update the column names
</span><span class="nf">names</span><span class="p">(</span><span class="n">dat_part2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"zip_first5"</span><span class="p">,</span><span class="w"> </span><span class="s2">"zip_last4"</span><span class="p">)</span><span class="w">
</span><span class="c1"># print result
</span><span class="n">dat_part2</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##   zip_first5 zip_last4
## 1     07921       7028
## 2      96101      3113
## 3      96101      3113
## 4     95207           
## 5     97741</code></pre></figure>

<p>Notice how similar these two chunks of code! If you cannot appreciate their neatness, go back and read the definition of <code class="highlighter-rouge">split_by()</code> again. Understand what it does.</p>

<p>Next, we combine <code class="highlighter-rouge">dat_part1</code> and <code class="highlighter-rouge">dat_part2</code> into one data frame, and check the variables.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">dat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">dat_part1</span><span class="p">,</span><span class="w"> </span><span class="n">dat_part2</span><span class="p">)</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 'data.frame':	5 obs. of  4 variables:
##  $ city      : chr  "BEDMINISTER" "ALTURAS" "ALTURAS" "STOCKTON" ...
##  $ state     : chr  " NJ" " CA" " CA" " CA" ...
##  $ zip_first5: chr  "07921 " "96101" "96101" "95207 " ...
##  $ zip_last4 : chr  "7028" "3113" " 3113" " " ...</code></pre></figure>

<p>We observe that <code class="highlighter-rouge">state</code> has a space in front of all its elements, <code class="highlighter-rouge">zip_first5</code> has spaces trailing some of its elements, and <code class="highlighter-rouge">zip_last4</code> also has spaces in some of its elements. We need to remove the spaces, and that’s what we’re doing next.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># make a function to remove a single space
</span><span class="n">rm_space</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rm_char</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span><span class="w">
</span><span class="c1"># lapply the function just made to every column of dat
# pay attention to the left side of the equal sign
</span><span class="n">dat</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">rm_space</span><span class="p">)</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 'data.frame':	5 obs. of  4 variables:
##  $ city      : chr  "BEDMINISTER" "ALTURAS" "ALTURAS" "STOCKTON" ...
##  $ state     : chr  "NJ" "CA" "CA" "CA" ...
##  $ zip_first5: chr  "07921" "96101" "96101" "95207" ...
##  $ zip_last4 : chr  "7028" "3113" "3113" "" ...</code></pre></figure>

<p>Pause for a moment, and go back to read the definition of <code class="highlighter-rouge">rm_char()</code> again. Make sure you understand what it does.</p>

<p>Finally, the action of removing spaces caused empty strings for some values, and we need to replace them with NA’s.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># make a function to replace "" with NA
</span><span class="n">fix_missing_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fix_missing</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="w">
</span><span class="c1"># lapply the function just made to every column of dat
# pay attention again to the left side of the equal sign
</span><span class="n">dat</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w"> </span><span class="n">fix_missing_empty</span><span class="p">)</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## 'data.frame':	5 obs. of  4 variables:
##  $ city      : chr  "BEDMINISTER" "ALTURAS" "ALTURAS" "STOCKTON" ...
##  $ state     : chr  "NJ" "CA" "CA" "CA" ...
##  $ zip_first5: chr  "07921" "96101" "96101" "95207" ...
##  $ zip_last4 : chr  "7028" "3113" "3113" NA ...</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">dat</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##          city state zip_first5 zip_last4
## 1 BEDMINISTER    NJ      07921      7028
## 2     ALTURAS    CA      96101      3113
## 3     ALTURAS    CA      96101      3113
## 4    STOCKTON    CA      95207      &lt;NA&gt;
## 5      MADRAS    OR      97741      &lt;NA&gt;</code></pre></figure>

<p>Do you understand what <code class="highlighter-rouge">fix_missing()</code> does? If not, go back and read its definition again…</p>

<p>This article is inspired by Hadley’s book “Advanced R”, you can <a rel="nofollow" href="http://www.amazon.com/gp/product/1466586966/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1466586966&amp;linkCode=as2&amp;tag=cabaceo-20&amp;linkId=2GDWMZSF4NX32QIO">buy it from Amazon</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=cabaceo-20&amp;l=as2&amp;o=1&amp;a=1466586966" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
or read it <a href="http://adv-r.had.co.nz/Functions.html">online</a> for FREE.</p>

		<!-- Begin MailChimp Signup Form -->
<html>
<head>
<link href="//cdn-images.mailchimp.com/embedcode/classic-081711.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background: #EBF2F2; clear:left; font:14px Helvetica,Arial,sans-serif; border: 1px solid #ccc; padding: 20px 15px; text-align: center}
	#mc_embed_signup input {
		background: #fff;
		border: 1px solid #ccc;
		font-size: 15px;
		margin-bottom: 10px;
		padding: 8px 10px;
		border-radius: 3px;
		-moz-border-radius: 3px;
		-webkit-border-radius: 3px;
		box-shadow: 0 2px 2px #ddd;
		-moz-box-shadow: 0 2px 2px #ddd;
		-webkit-box-shadow: 0 2px 2px #ddd
	}
	#mc_embed_signup input.name { background: #fff  no-repeat 10px center; padding-left: 5px }
	#mc_embed_signup input.email { background: #fff no-repeat 10px center; padding-left: 5px }
	#mc_embed_signup .button{ background: #217b30; -moz-border-radius: 8; font: 18px; color:#FFFFFF; }
	#mc_embed_signup .button:hover{ background: #217b30; color: #c6ffd1; }
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
</head>
<div id="mc_embed_signup">
<form action="//gmlang.us9.list-manage.com/subscribe/post?u=66768baba1811dbdb4e186167&amp;id=0288c18c07" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
    <div id="mc_embed_signup_scroll">
	<h2>If you enjoyed this post, get updates. It's FREE</h2>
<div class="mc-field-group">
	<label for="mce-FIRST_NAME">Enter Your First Name </label>
	<input type="text" value="" name="FIRST_NAME" class="required name" id="mce-FIRST_NAME">
</div>
<div class="mc-field-group">
	<label for="mce-EMAIL">Enter Your Email </label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
    <input type="reset" id="chimp-reset" style="display:none"/>
</div>
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_66768baba1811dbdb4e186167_0288c18c07" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Get Updates!" name="subscribe" id="mc-embedded-subscribe" class="button bottom-clear"></div>
    </div>
</form>
</div>
</html>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
	 	$(".bottom-clear").click(function() {
    		 setTimeout(function(){
				$('#chimp-reset').click();
    		 },1000); 
		});
    });
</script> 
<!--End mc_embed_signup-->
        <div id="disqus_thread"></div><!-- /#disqus_thread -->
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://masterr.org/r/functions-that-eat-functions/" class="btn" title="Functions that eat functions">Previous</a>
      
      
        <a href="http://masterr.org/r/how-to-read-in-date-variables-as-Date/" class="btn" title="How to read in date variables as Date">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    
<span>&copy; 2017 Guangming Lang. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	
	
	
	
	
	
	
	
	
<!-- no feed button <a href="http://masterr.org/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a> -->
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://masterr.org/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://masterr.org/assets/js/scripts.min.js"></script>

<!-- Jekyll Simple Search option -->
<script>
  $(document).ready(function() {
      $('.search-field').jekyllSearch({
          jsonFile: 'http://masterr.org/search.json',
          searchResults: '.search-results',
          template: '<li><article><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></article></li>',
          fuzzy: true,
          noResults: '<p>Nothing found.</p>'
        });
  });

  (function( $, window, undefined ) {
    
     var bs = {
          close: $(".close-btn"),
          searchform: $(".search-form"),
          canvas: $(".js-menu-screen"),
          dothis: $('.dosearch')
      };
    
    bs.dothis.on('click', function() {
      $('.search-wrapper').css({ display: "block" });
      $('body').toggleClass('no-scroll');
      bs.searchform.toggleClass('active');
      bs.searchform.find('input').focus();
      bs.canvas.toggleClass('is-visible');
    });
    
      bs.close.on('click', function() {
        $('.search-wrapper').removeAttr( 'style' );
        $('body').toggleClass('no-scroll');
        bs.searchform.toggleClass('active');
        bs.canvas.removeClass('is-visible');
    });
  })( jQuery, window );
</script>


<!-- doesn't work optimally 
author's Asynchronous Google Analytics snippet

<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-57697212-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

-->

<!-- google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57697212-1', 'auto');
  ga('send', 'pageview');

</script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'masterrorg'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



<!-- Mathjax -->
<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
	        

</body>
</html>
